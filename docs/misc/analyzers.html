<html><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>Elastic4s</title><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="Elasticsearch Scala Client" /><meta name="author" content="Stephen Samuel" /><meta name="og:image" content="/elastic4s/img/poster.png" /><meta name="og:title" content="Elastic4s" /><meta name="og:site_name" content="Elastic4s" /><meta name="og:url" content="https://sksamuel.github.io/elastic4s" /><meta name="og:type" content="website" /><meta name="og:description" content="Elasticsearch Scala Client" /><meta name="twitter:image" content="/elastic4s/img/poster.png" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="" /><link rel="icon" type="image/png" href="/elastic4s/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/elastic4s/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/elastic4s/css/style.css" /><link rel="stylesheet" href="/elastic4s/css/palette.css" /><link rel="stylesheet" href="/elastic4s/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/elastic4s/" class="brand"><div class="brand-wrapper" style="background:url('/elastic4s/img/sidebar_brand.png') no-repeat"><span>Elastic4s</span></div></a></li> <li><a href="/elastic4s/docs/index.html" class="">Getting Started</a></li> <li><a href="/elastic4s/docs/document/index.html" class="">Document API</a> <ul class="sub_section"> <li><a href="/elastic4s/docs/document/index.html" class="">Index</a></li> <li><a href="/elastic4s/docs/document/get.html" class="">Get</a></li> <li><a href="/elastic4s/docs/document/multiget.html" class="">Multi Get</a></li> <li><a href="/elastic4s/docs/document/delete.html" class="">Delete</a></li> <li><a href="/elastic4s/docs/document/update.html" class="">Update</a></li> <li><a href="/elastic4s/docs/document/bulk.html" class="">Bulk</a></li></ul></li> <li><a href="/elastic4s/docs/search/search.html" class="">Search API</a> <ul class="sub_section"> <li><a href="/elastic4s/docs/search/multisearch.html" class="">Multi Search</a></li> <li><a href="/elastic4s/docs/search/explain.html" class="">Explain</a></li> <li><a href="/elastic4s/docs/search/suggestions.html" class="">Suggestions</a></li> <li><a href="/elastic4s/docs/search/validate.html" class="">Validate</a></li> <li><a href="/elastic4s/docs/search/count.html" class="">Count</a></li></ul></li> <li><a href="/elastic4s/docs/indices/createindex.html" class="">Indices API</a> <ul class="sub_section"> <li><a href="/elastic4s/docs/indices/createindex.html" class="">Create Index</a></li> <li><a href="/elastic4s/docs/indices/aliases.html" class="">Aliases</a></li> <li><a href="/elastic4s/docs/indices/optimize.html" class="">Optimize</a></li></ul></li> <li><a href="/elastic4s/docs/misc/analyzers.html" class=" active ">Analyzers</a></li> <li><a href="/elastic4s/docs/misc/snapshot.html" class="">Snapshot</a></li> <li><a href="/elastic4s/docs/misc/javainterop.html" class="">Java Interop</a></li> <li><a href="/elastic4s/api/index.html" class="">Scaladoc</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="hidden-xs"><a href="https://github.com/sksamuel/elastic4s"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li class="hidden-xs"><a href="https://github.com/sksamuel/elastic4s"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Elastic4s Elasticsearch Scala Client');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Elastic4s Elasticsearch Scala Client');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="sksamuel" data-github-repo="elastic4s"><div class="content-wrapper"><section><h1 id="analyzers">Analyzers</h1>

<p>Analyzers are created from a single Tokenizer, zero or more TokenFilters and zero or more CharFilters and have a name that is used to refer to them.</p>

<p>Character filters are used to preprocess the string of characters before it is passed to the tokenizer. A character filter may be used to strip out HTML markup, or to convert <code class="highlighter-rouge">&amp;</code> characters to the word <code class="highlighter-rouge">and</code>.</p>

<p>Tokenizers split the incoming string into tokens. A very simple example (but common use case) is to split a string into tokens on whitespace. So “Tony Mowbray” would be split into “Tony” and “Mowbray”.</p>

<p>TokenFilters apply after the tokenizer, and can modify the incoming tokens. So if we applied a reverse TokenFilter, then [“Tony”, “Mowbray”] would become [“ynot”, “yarbwom”].</p>

<p>By default Elasticsearch registers multiple built-in analyzers. These are</p>

<ul>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html">standard analyzer</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-simple-analyzer.html">simple analyzer</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-whitespace-analyzer.html">whitespace analyzer</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-stop-analyzer.html">stop analyzer</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-keyword-analyzer.html">keyword analyzer</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-pattern-analyzer.html">pattern analyzer</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-lang-analyzer.html">language analyzers</a></li>
  <li><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-snowball-analyzer.html">snowball analyzer</a></li>
</ul>

<p>You can use these by simply using the case object for each analyzer. Eg, SimpleAnalyzer is a case object that you can pass as a parameter when you need to specify an analyzer. You don’t have to do anything to explicity enable them as they are always there.</p>

<p>Here is an example of using a WhitespaceAnalyzer to split up a field on whitespace.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">create</span><span class="o">.</span><span class="n">index</span><span class="o">(</span><span class="s">"people"</span><span class="o">).</span><span class="n">mappings</span><span class="o">(</span>
  <span class="s">"scientists"</span> <span class="n">as</span> <span class="o">{</span>
    <span class="s">"name"</span> <span class="n">analyzer</span> <span class="nc">WhitespaceAnalyzer</span>
  <span class="o">}</span>
<span class="o">)</span>
</code></pre>
</div>

<h2 id="custom-analyzers">Custom Analyzers</h2>

<p>Sometimes the built in analyzers aren’t suitable for your particular use case and you want to be able to specify your own analyzer. Elasticsearch allows you to create a <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-custom-analyzer.html">custom analyzer</a> which gives you full control over how an analyzer is specified. Also, there are shortcuts that allow you to use one of the built-in analyzers but with your own options (for example, if you wanted to use the “stop analzyer” but with your own list of stop words). Not all built-in analyzers can be modified, eg the WhitespaceAnalyzer has no options.</p>

<p>To use a shortcut, the DSL makes it very easy. For example, lets create a mapping for “myindex/users”, and we want to index each user’s name by splitting up on commas. In this index we will register a pattern analyzer that will split up tokens on commas.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">create</span><span class="o">.</span><span class="n">index</span><span class="o">(</span><span class="s">"people"</span><span class="o">).</span><span class="n">mappings</span><span class="o">(</span>
  <span class="s">"scientists"</span> <span class="n">as</span> <span class="o">{</span>
    <span class="s">"name"</span> <span class="n">analyzer</span> <span class="s">"pat1"</span>
  <span class="o">}</span>
<span class="o">).</span><span class="n">analysis</span><span class="o">(</span>
  <span class="nc">PatternAnalyzerDefinition</span><span class="o">(</span><span class="s">"pat1"</span><span class="o">,</span> <span class="n">regex</span> <span class="k">=</span> <span class="s">","</span><span class="o">)</span>
<span class="o">)</span>
</code></pre>
</div>

<p>Notice that we give the analyzer a name. This is so we can refer to it in the mapping part. You can use the same definition in multiple mappings for the same index, and you only need to specify the definition once. It’s also possible to use the same name as one of the built in analyzers. If you do this, then you will override the built-in analyzer.</p>

<p>If the shortcut definitions are still not cutting it, then we can create a fully custom analyzer. Remember from the original definition of an analyzer, you specify a tokenizer, and optionally tokenfilters and charfilters.</p>

<p>Here is an example of registering a custom analyzer that uses a whitespace tokenizer, with lowercase and reverse token filters (just for fun).</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">create</span><span class="o">.</span><span class="n">index</span><span class="o">(</span><span class="s">"people"</span><span class="o">).</span><span class="n">mappings</span><span class="o">(</span>
  <span class="s">"scientists"</span> <span class="n">as</span> <span class="o">{</span>
    <span class="s">"name"</span> <span class="n">analyzer</span> <span class="s">"custom1"</span>
  <span class="o">}</span>
<span class="o">).</span><span class="n">analysis</span><span class="o">(</span>
  <span class="nc">CustomAnalyzerDefinition</span><span class="o">(</span>
    <span class="s">"custom1"</span><span class="o">,</span>
    <span class="nc">WhitespaceTokenizer</span><span class="o">,</span>
    <span class="nc">LowercaseTokenFilter</span><span class="o">,</span>
    <span class="nc">ReverseTokenFilter</span>
  <span class="o">)</span>
<span class="o">)</span>
</code></pre>
</div>

<p>We can of course use as many analyzers as we want. Here is a nonsense but technically valid example used in one of the unit tests.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">create</span><span class="o">.</span><span class="n">index</span><span class="o">(</span><span class="s">"users"</span><span class="o">).</span><span class="n">mappings</span><span class="o">(</span>
  <span class="s">"tweets"</span> <span class="n">as</span><span class="o">(</span>
    <span class="n">id</span> <span class="n">typed</span> <span class="nc">StringType</span> <span class="n">analyzer</span> <span class="nc">KeywordAnalyzer</span> <span class="n">store</span> <span class="kc">true</span> <span class="n">includeInAll</span> <span class="kc">true</span><span class="o">,</span>
    <span class="s">"name"</span> <span class="n">typed</span> <span class="nc">GeoPointType</span> <span class="n">analyzer</span> <span class="nc">SimpleAnalyzer</span> <span class="n">boost</span> <span class="mi">4</span> <span class="n">index</span> <span class="s">"not_analyzed"</span><span class="o">,</span>
    <span class="s">"content"</span> <span class="n">typed</span> <span class="nc">DateType</span> <span class="n">analyzer</span> <span class="s">"myAnalyzer3"</span> <span class="n">nullValue</span> <span class="s">"no content"</span>
  <span class="o">),</span>
  <span class="n">map</span><span class="o">(</span><span class="s">"users"</span><span class="o">).</span><span class="n">as</span><span class="o">(</span>
    <span class="s">"name"</span> <span class="n">typed</span> <span class="nc">IpType</span> <span class="n">analyzer</span> <span class="nc">WhitespaceAnalyzer</span> <span class="n">omitNorms</span> <span class="kc">true</span><span class="o">,</span>
    <span class="s">"location"</span> <span class="n">typed</span> <span class="nc">IntegerType</span> <span class="n">analyzer</span> <span class="s">"myAnalyzer2"</span> <span class="n">ignoreAbove</span> <span class="mi">50</span><span class="o">,</span>
    <span class="s">"email"</span> <span class="n">typed</span> <span class="nc">BinaryType</span> <span class="n">analyzer</span> <span class="nc">StandardAnalyzer</span><span class="o">,</span>
    <span class="s">"picture"</span> <span class="n">typed</span> <span class="nc">AttachmentType</span><span class="o">,</span>
    <span class="s">"age"</span> <span class="n">typed</span> <span class="nc">FloatType</span><span class="o">,</span>
    <span class="s">"area"</span> <span class="n">typed</span> <span class="nc">GeoShapeType</span>
  <span class="o">)</span>
<span class="o">).</span><span class="n">analysis</span><span class="o">(</span>
  <span class="nc">PatternAnalyzerDefinition</span><span class="o">(</span><span class="s">"patternAnalyzer"</span><span class="o">,</span> <span class="n">regex</span> <span class="k">=</span> <span class="s">"[a-z]"</span><span class="o">),</span>
  <span class="nc">SnowballAnalyzerDefinition</span><span class="o">(</span><span class="s">"mysnowball"</span><span class="o">,</span> <span class="n">stopwords</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"stop1"</span><span class="o">,</span> <span class="s">"stop2"</span><span class="o">,</span> <span class="s">"stop3"</span><span class="o">)),</span>
  <span class="nc">CustomAnalyzerDefinition</span><span class="o">(</span>
   <span class="s">"myAnalyzer2"</span><span class="o">,</span>
    <span class="nc">StandardTokenizer</span><span class="o">(</span><span class="s">"myTokenizer1"</span><span class="o">,</span> <span class="mi">900</span><span class="o">),</span>
    <span class="nc">LengthTokenFilter</span><span class="o">(</span><span class="s">"myTokenFilter2"</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">max</span> <span class="k">=</span> <span class="mi">10</span><span class="o">),</span>
    <span class="nc">UniqueTokenFilter</span><span class="o">(</span><span class="s">"myTokenFilter3"</span><span class="o">,</span> <span class="n">onlyOnSamePosition</span> <span class="k">=</span> <span class="kc">true</span><span class="o">),</span>
    <span class="nc">PatternReplaceTokenFilter</span><span class="o">(</span><span class="s">"prTokenFilter"</span><span class="o">,</span> <span class="s">"pattern"</span><span class="o">,</span> <span class="s">"rep"</span><span class="o">)</span>
  <span class="o">),</span>
  <span class="nc">CustomAnalyzerDefinition</span><span class="o">(</span>
    <span class="s">"myAnalyzer3"</span><span class="o">,</span>
    <span class="nc">LowercaseTokenizer</span><span class="o">,</span>
    <span class="nc">StopTokenFilter</span><span class="o">(</span><span class="s">"myTokenFilter1"</span><span class="o">,</span> <span class="n">enablePositionIncrements</span> <span class="k">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">ignoreCase</span> <span class="k">=</span> <span class="kc">true</span><span class="o">),</span>
    <span class="nc">ReverseTokenFilter</span><span class="o">,</span>
    <span class="nc">LimitTokenFilter</span><span class="o">(</span><span class="s">"myTokenFilter5"</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="n">consumeAllTokens</span> <span class="k">=</span> <span class="kc">false</span><span class="o">),</span>
    <span class="nc">StemmerOverrideTokenFilter</span><span class="o">(</span><span class="s">"stemmerTokenFilter"</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="s">"rule1"</span><span class="o">,</span> <span class="s">"rule2"</span><span class="o">)),</span>
    <span class="nc">HtmlStripCharFilter</span><span class="o">,</span>
    <span class="nc">MappingCharFilter</span><span class="o">(</span><span class="s">"mapping_charfilter"</span><span class="o">,</span> <span class="s">"ph"</span> <span class="o">-&gt;</span> <span class="s">"f"</span><span class="o">,</span> <span class="s">"qu"</span> <span class="o">-&gt;</span> <span class="s">"q"</span><span class="o">),</span>
    <span class="nc">PatternReplaceCharFilter</span><span class="o">(</span>
      <span class="s">"pattern_replace_charfilter"</span><span class="o">,</span>
      <span class="n">pattern</span> <span class="k">=</span> <span class="s">"sample(.*)"</span><span class="o">,</span>
      <span class="n">replacement</span> <span class="k">=</span> <span class="s">"replacedSample $1"</span>
    <span class="o">)</span>
  <span class="o">)</span>
<span class="o">)</span>
</code></pre>
</div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/elastic4s/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/elastic4s/js/main.js"></script></body></html>